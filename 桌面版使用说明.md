# 论文反插助手 - 桌面版使用说明

## 📖 应用介绍

这是**纯桌面窗口版本**的论文反插助手，使用 PyQt5 开发，无需浏览器即可使用。

### 主要特点

- ✅ **纯桌面应用** - 真正的 Windows 窗口程序，不是网页
- ✅ **独立运行** - 不依赖 localhost，不需要打开浏览器
- ✅ **美观界面** - 现代化设计，绿色主题
- ✅ **响应迅速** - 后台工作线程，界面不卡顿
- ✅ **配置保存** - 自动保存 API 设置
- ✅ **完整功能** - 与网页版功能完全一致

---

## 🚀 快速开始

### 方法 1：使用启动脚本（推荐）

双击运行：
```
启动桌面版.bat
```

### 方法 2：命令行启动

```cmd
cd /d "E:\AI_projects\论文反插助手 - 副本"
python desktop_app.py
```

### 方法 3：打包后的 EXE

如果已经打包成 EXE，直接双击：
```
论文反插助手.exe
```

---

## 📋 使用步骤

### 第一步：配置 API

1. 打开应用后，在**右侧边栏**找到"API 配置"
2. 选择 API 提供商（DeepSeek / OpenAI / Anthropic）
3. 输入 API 密钥
4. 选择模型
5. 点击"💾 保存设置"

**支持的 API 提供商：**
- **DeepSeek** - 推荐，性价比高
  - 模型：deepseek-chat, deepseek-reasoner
- **OpenAI**
  - 模型：gpt-4o, gpt-4o-mini, gpt-4-turbo
- **Anthropic**
  - 模型：claude-3-5-sonnet-20241022

---

### 第二步：导入文献库

1. 切换到 **"📚 导入文献库"** 标签页
2. 阅读操作指南，从 Web of Science 导出文献
3. 点击 **"📁 添加文件"**，选择 WOS 导出的.txt 文件
   - 支持批量选择多个文件
4. 点击 **"🚀 开始导入"**
5. 等待导入完成，查看导入结果

**Web of Science 导出步骤：**
1. 访问 https://www.webofscience.com
2. 搜索文献并筛选
3. 选择要导出的文献（建议 50-500 篇）
4. 点击 "Export" → "Plain Text File"
5. 选择 "Full Record" 格式
6. 下载.txt 文件

---

### 第三步：上传草稿

1. 切换到 **"📝 上传草稿"** 标签页
2. 确认文献库已加载（显示文献数量）
3. 点击 **"📄 选择 Word 文档"**
4. 选择你的论文草稿（.docx 格式）
5. 点击 **"🔬 分析文档"**
6. 查看分析结果：
   - 总句子数
   - 需要引用的句子数
   - 段落数

---

### 第四步：AI 匹配引用

1. 切换到 **"⚡ AI 匹配"** 标签页
2. 勾选选项（可选）：
   - ✅ 跳过已有引用的句子
3. 点击 **"🤖 开始 AI 匹配"**
4. 等待匹配完成（显示进度条）
5. 匹配完成后自动跳转到结果页面

**匹配时间：**
- 小文献库（<100 篇）：1-2 分钟
- 中等文献库（100-500 篇）：3-5 分钟
- 大文献库（>500 篇）：5-10 分钟

---

### 第五步：查看和导出结果

1. 在 **"📊 查看与导出"** 标签页
2. 查看匹配结果列表
3. 点击 **"🔄 刷新结果"** 显示所有匹配
4. 选择输出格式：
   - Word 文档 (.docx)
   - Markdown (.md)
   - 纯文本 (.txt)
5. 点击 **"💾 导出文档"**
6. 选择保存位置
7. 完成！

---

## ⚙️ 配置说明

### API 配置

| 设置项 | 说明 | 推荐值 |
|--------|------|--------|
| API 提供商 | 选择 AI 模型服务商 | DeepSeek |
| API 密钥 | 你的 API 密钥 | 需自行申请 |
| 模型 | 选择具体模型 | deepseek-chat |

### 引用设置

| 设置项 | 说明 | 推荐值 |
|--------|------|--------|
| 引用风格 | 文中引用格式 | author-year |
| 每句最大引用 | 每句话最多插入的引用数 | 2 |
| 最低相关性 | 相关性阈值（0-100） | 60 |

---

## 📁 文件说明

### 项目文件

```
论文反插助手 - 副本/
├── desktop_app.py           # 桌面版主程序
├── 启动桌面版.bat           # 快速启动脚本
├── requirements.txt         # Python 依赖
├── app.py                   # 网页版（可选）
├── run_app.py               # 网页版启动器（可选）
│
├── src/                     # 核心代码
│   ├── literature/
│   │   └── db_manager.py    # 文献数据库管理
│   ├── draft/
│   │   ├── analyzer.py      # 草稿分析
│   │   └── context_understanding.py
│   ├── citation/
│   │   ├── matcher.py       # 引用匹配
│   │   ├── ai_matcher.py    # AI 匹配器
│   │   ├── search_engine.py # 搜索引擎
│   │   └── ...
│   └── utils/
│       └── config.py        # 配置管理
│
├── config/                  # 配置文件
│   └── config.yaml
│
├── data/                    # 数据库目录
│   └── literature.db
│
├── models/                  # AI 模型目录
│   ├── all-MiniLM-L6-v2/
│   └── cross-encoder_ms-marco-MiniLM-L-6-v2/
│
├── uploads/                 # 上传文件临时目录
└── output/                  # 导出文件目录
```

---

## 🐛 常见问题

### Q1: 启动时提示 "找不到模块"

**解决：**
```cmd
pip install -r requirements.txt
```

### Q2: 点击"开始 AI 匹配"没反应

**检查：**
1. 是否已导入文献库
2. 是否已上传并分析草稿
3. 是否已配置 API 密钥
4. 查看底部状态栏的错误提示

### Q3: 匹配速度很慢

**可能原因：**
1. 文献库太大（>1000 篇）
2. 网络速度慢
3. API 响应慢

**解决方法：**
- 减少文献库大小（建议 100-500 篇）
- 检查网络连接
- 降低"每句最大引用"数量

### Q4: 导出功能不可用

**说明：** 导出功能需要完整实现，当前版本可能需要进一步完善。

**临时方案：**
- 使用网页版导出
- 或手动复制结果

### Q5: 设置无法保存

**解决：**
1. 确保有写入权限
2. 检查程序所在目录是否可写
3. 以管理员身份运行

---

## 🔧 技术细节

### 系统要求

- **操作系统**: Windows 7/8/10/11
- **Python**: 3.8+
- **内存**: 建议 4GB+
- **磁盘**: 至少 500MB 可用空间

### 依赖库

```txt
PyQt5>=5.15.0
python-docx>=0.8.11
pandas>=1.5.0
numpy>=1.21.0
nltk>=3.8.0
scikit-learn>=1.3.0
pyyaml>=6.0
requests>=2.31.0
faiss-cpu>=1.7.4
sentence-transformers>=2.2.0
```

### 打包成 EXE

使用 GitHub Actions 自动打包：

1. 访问：https://github.com/jiangye999/paper-citation-assistant/actions
2. 选择 "Build Windows EXE (Simple)"
3. 点击 "Run workflow"
4. 等待完成
5. 下载 artifact

---

## 📞 技术支持

### 遇到问题？

1. **查看日志** - 控制台会显示详细错误信息
2. **检查配置** - 确认 API 密钥正确
3. **重启应用** - 有时重启能解决临时问题
4. **更新依赖** - `pip install -r requirements.txt --upgrade`

### 获取帮助

- **GitHub Issues**: https://github.com/jiangye999/paper-citation-assistant/issues
- **查看文档**: README.md
- **检查日志**: 控制台输出

---

## 📝 更新日志

### v1.0.0 (桌面版)
- ✅ 完整的 PyQt5 桌面界面
- ✅ 文献批量导入
- ✅ Word 文档分析
- ✅ AI 引用匹配
- ✅ 结果查看和导出
- ✅ 配置保存功能
- ✅ 后台工作线程
- ✅ 进度提示

---

## 📄 许可证

MIT License

---

**祝你使用愉快！** 🎉

如有任何问题，请随时反馈。
